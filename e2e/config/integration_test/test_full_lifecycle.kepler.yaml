services:
  full-lifecycle-service:
    command: ["sh", "-c", "echo FULL_LIFECYCLE_START; sleep 300"]
    working_dir: WATCH_DIR
    restart:
      policy: always
      watch:
        - "**/*"
    healthcheck:
      test: ["CMD-SHELL", "exit 0"]
      interval: 2s
      timeout: 5s
      retries: 2
      start_period: 0s
    hooks:
      on_start:
        run: |
          echo "ON_START_HOOK" >> MARKER_FILE
      on_stop:
        run: |
          echo "ON_STOP_HOOK" >> MARKER_FILE
      on_healthcheck_success:
        run: |
          echo "HEALTHCHECK_SUCCESS" >> MARKER_FILE
