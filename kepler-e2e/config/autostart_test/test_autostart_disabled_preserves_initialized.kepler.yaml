# Test that service.initialized persists across daemon restart when autostart is false.
# After daemon restart + kepler start, the init hook should NOT re-fire.
kepler:
  logs:
    buffer_size: 0

services:
  init-service:
    command: ["sh", "-c", "echo STARTED >> MARKER_FILE && sleep 3600"]
    hooks:
      pre_start:
        if: ${{ not service.initialized }}$
        run: "echo ON_INIT >> MARKER_FILE"
