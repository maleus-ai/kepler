kepler:
  logs:
    buffer_size: 0

services:
  hook-context-service:
    command: ["sh", "-c", "echo HOOK_CONTEXT_RUNNING && sleep 30"]
    hooks:
      pre_start:
        environment: !lua |
          return {"SERVICE_NAME=" .. (ctx.service_name or "nil")}
        run: "echo SERVICE=$SERVICE_NAME >> __MARKER_FILE__"
    restart: no
