kepler:
  logs:
    buffer_size: 0

services:
  getgroups-strict-self-svc:
    command: !lua |
      -- With strict hardening, querying own user should succeed
      local user = owner and owner.user or nil
      if user then
        local groups = os.getgroups(user)
        return {"sh", "-c", "echo SELF_GROUPS=" .. table.concat(groups, ",") .. "; sleep 300"}
      else
        return {"sh", "-c", "echo NO_OWNER; sleep 300"}
      end
