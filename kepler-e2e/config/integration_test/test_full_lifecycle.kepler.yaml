kepler:
  logs:
    buffer_size: 0

services:
  full-lifecycle-service:
    command: ["sh", "-c", "echo FULL_LIFECYCLE_START; sleep 300"]
    working_dir: __WATCH_DIR__
    restart:
      policy: always
      watch:
        - "**/*"
    healthcheck:
      test: ["sh", "-c", "exit 0"]
      interval: 2s
      timeout: 5s
      retries: 2
      start_period: 0s
    hooks:
      pre_start:
        run: |
          echo "PRE_START_HOOK" >> __MARKER_FILE__
      pre_stop:
        run: |
          echo "PRE_STOP_HOOK" >> __MARKER_FILE__
      post_healthcheck_success:
        run: |
          echo "HEALTHCHECK_SUCCESS" >> __MARKER_FILE__
