# Test that outputs persist across daemon restart
# Producer exits with outputs, consumer should still read them after daemon restart

kepler:
  autostart: true
  logs:
    buffer_size: 0

services:
  producer:
    command: ["sh", "-c", "echo '::output::port=9090'; echo PRODUCER_DONE; exit 0"]
    restart: no
    output: true

  consumer:
    command: ["sh", "-c", "echo CONSUMER_PORT=${{ deps['producer'].outputs.port }}$; sleep 300"]
    depends_on:
      producer:
        condition: service_completed_successfully
